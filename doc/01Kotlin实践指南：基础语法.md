# Kotlinå®æŒ‡æŒ‡å—ï¼šåŸºç¡€è¯­æ³•

**å…³äºä½œè€…**

>éƒ­å­æ˜Ÿï¼Œç¨‹åºå‘˜ï¼Œå‰ä»–æ‰‹ï¼Œä¸»è¦ä»äº‹Androidå¹³å°åŸºç¡€æ¶æ„æ–¹é¢çš„å·¥ä½œï¼Œæ¬¢è¿äº¤æµæŠ€æœ¯æ–¹é¢çš„é—®é¢˜ï¼Œå¯ä»¥å»æˆ‘çš„[Github](https://github.com/guoxiaoxing)æissueæˆ–è€…å‘é‚®ä»¶è‡³guoxiaoxingse@163.comä¸æˆ‘äº¤æµã€‚

**æ–‡ç« ç›®å½•**

- ä¸€ å‡½æ•°å’Œå˜é‡
- äºŒ ç±»å’Œå±æ€§
- ä¸‰ æ§åˆ¶è¯­å¥

æ³¨ï¼šæ–‡ç« ä¸­"ä¸¾ä¾‹"å­—æ ·ä»£è¡¨æ‰€ä¸¾çš„ä¾‹å­ï¼Œ"åŒºåˆ«"å­—æ ·ä»£ç Kotlinä¸Javaä¸åŒçš„åœ°æ–¹ï¼Œ

æ›´å¤šæ–‡ç« è¯·å‚è§[æ–‡ç« ç›®å½•](https://github.com/guoxiaoxing/kotlin)ã€‚

æœ¬ç¯‡æ–‡ç« æ˜¯æœ¬ç³»åˆ—æ–‡ç« çš„å¼€ç¯‡æ–‡ç« ï¼Œä¸»è¦ä»‹ç»Javaä¸­çš„ç¼–ç¨‹æ¦‚å¿µï¼ˆè¯­å¥ã€å‡½æ•°ã€ç±»ç­‰ï¼‰æ˜¯å¦‚ä½•æ˜ å°„åˆ°Kotlinçš„ä»£ç ä¸­çš„ã€‚æœ¬æ–‡çš„ç›®çš„åœ¨äºå¸®åŠ©å¤§å®¶å¿«é€Ÿç†è§£Javaé‡Œçš„è¯­æ³•åœ¨Kotlinä¸­å¦‚ä½•å®ç°ï¼Œä»¥åŠ
å®ƒä»¬ä¹‹é—´æœ‰ä»€ä¹ˆåŒºåˆ«ã€‚

>Kotlinæ˜¯ä¸€ç§åœ¨Javaè™šæ‹Ÿæœºä¸Šè¿è¡Œçš„é™æ€ç±»å‹ç¼–ç¨‹è¯­è¨€ã€‚

- Kotlinæ˜¯é™æ€è¯­è¨€å¹¶ä¸”æ”¯æŒç±»å‹æ¨å¯¼ï¼Œå…è®¸ç»´æŠ¤æ­£ç¡®æ€§ä¸æ€§èƒ½çš„åŒæ—¶ä¿è¯äº†æºä»£ç çš„ç®€æ´æ€§ã€‚
- Kotlinæ”¯æŒå‡½æ•°å¼å’Œé¢å‘å¯¹è±¡ä¸¤ç§ç¼–ç¨‹é£æ ¼ï¼Œé€šè¿‡å¤´ç­‰å‡½æ•°ä½¿å¾—æ›´é«˜çº§åˆ«çš„æŠ½è±¡æˆä¸ºäº†å¯èƒ½ï¼Œé€šè¿‡æ”¯æŒä¸å¯å˜å€¼ç®€åŒ–äº†æµ‹è¯•å’Œå¤šçº¿ç¨‹å¹¶å‘ã€‚
- Kotlinä¸Javaå…·æœ‰è‰¯å¥½çš„äº’æ“ä½œæ€§ï¼ŒKotlinå¯ä»¥å»ä½¿ç”¨Javaçš„APIã€ç»§æ‰¿Javaçš„ç±»å‹ã€å®ç°Javaçš„æ¥å£ï¼ŒåŒæ ·çš„ï¼ŒJavaä¹Ÿå¯ä»¥åƒè°ƒç”¨å…¶ä»–Javaä»£ç é‚£æ ·è°ƒç”¨Kotlinï¼Œè¿™ä¸ºè¯­è¨€æ··ç”¨æ‰“ä¸‹äº†åšå®çš„åŸºç¡€ã€‚


## ä¸€ å‡½æ•°å’Œå˜é‡

## 1.1 å‡½æ•°

>å‡½æ•°çš„å£°æ˜ä»¥funå…³é”®å­—å¼€å§‹ï¼Œå‡½æ•°åç§°ç´§è·Ÿå…¶åï¼Œç„¶åæ˜¯å½¢å‚åˆ—è¡¨ï¼Œå½¢å‚åˆ—è¡¨åé¢æ˜¯è¿”å›å€¼ï¼Œå¦‚æœæ²¡æœ‰æŒ‡å®šè¿”å›å€¼ï¼Œé»˜è®¤çš„è¿”å›å€¼æ˜¯Unitã€‚

**ä¸¾ä¾‹**

```kotlin
fun max(a: Int, b: Int): Int {
    return if (a > b) a else b
}
```

å¯ä»¥çœ‹åˆ°åœ¨è¿™ä¸ªå‡½æ•°é‡Œifè¡¨è¾¾å¼è¢«å½“åšè¿”å›å€¼ç›´æ¥è¿”å›ï¼Œè¿™ä¼¼ä¹ä¸Javaä¸å¤ªä¸€æ ·ï¼Œä¸ºä»€ä¹ˆä¼šè¿™æ ·å‘¢ï¼ŸğŸ¤”

**åŒºåˆ«**

åœ¨Kotlinä¸­ï¼Œifæ˜¯è¡¨è¾¾å¼ï¼Œè€Œåœ¨Javaä¸­ifæ˜¯è¯­å¥ã€‚

- è¡¨è¾¾å¼ï¼šè¡¨è¾¾å¼æœ‰å€¼ï¼Œå¹¶ä¸”å¯ä»¥ä½œä¸ºå¦ä¸€ä¸ªè¡¨è¾¾å¼çš„ä¸€éƒ¨åˆ†ä½¿ç”¨ã€‚
- è¯­å¥ï¼šè¯­å¥æ˜¯åŒ…å›´ç€å®ƒçš„ä»£ç å—çš„åº•å±‚å…ƒç´ ï¼Œè€Œä¸”å®ƒæ²¡æœ‰å€¼ã€‚

åœ¨Javaä¸­æ‰€æœ‰çš„æ§åˆ¶è¯­å¥éƒ½æ˜¯è¡¨è¾¾å¼ï¼Œè€Œåœ¨Kotlinä¸­ï¼Œé™¤äº†å¾ªç¯ï¼ˆforã€doä¸do/whileï¼‰æ˜¯è¯­å¥å¤–ï¼Œå…¶ä»–å¤§éƒ¨åˆ†æ§åˆ¶ç»“æ„éƒ½æ˜¯è¡¨è¾¾å¼ï¼Œéƒ½æœ‰å€¼ã€‚
è€Œæ°æ°åœ¨Javaä¸­æ˜¯è¡¨è¾¾å¼çš„èµ‹å€¼æ“ä½œï¼ˆa = 1ï¼‰åœ¨Kotlinä¸­å´æ˜¯è¯­å¥ï¼Œè¿™æ ·æœ‰åŠ©äºé¿å…æ¯”è¾ƒæ“ä½œï¼ˆ==ï¼‰å’Œèµ‹å€¼ï¼ˆ=ï¼‰æ“ä½œä¹‹é—´çš„æ··æ·†ã€‚

å¦‚æœå‡½æ•°ä¸­åªæœ‰ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œå¯ä»¥å°†è¿™ä¸ªè¡¨è¾¾å¼ä½œä¸ºå®Œæ•´çš„å‡½æ•°ä½“ï¼Œç§°ä¸ºè¡¨è¾¾å¼å‡½æ•°ä½“ï¼Œä¾‹å¦‚ï¼š

```kotlin
fun max(a: Int, b: Int): Int = if (a > b) a else b
```
## 1.2 å˜é‡

Kotlinå˜é‡çš„å£°æ˜ä»å…³é”®å­—varä¸valå¼€å§‹ï¼ŒKotlinä¼šè‡ªåŠ¨è¿›è¡Œç±»å‹æ¨å¯¼ï¼Œå› æ­¤ä½ æ— éœ€æ˜¾å¼çš„å£°æ˜ç±»å‹ã€‚

- valï¼šä¸å¯å˜å¼•ç”¨ï¼Œå˜é‡åœ¨åˆå§‹åŒ–ä¹‹åä¸èƒ½å†è¢«ä¿®æ”¹ï¼Œä¹Ÿå°±æ˜¯valå¼•ç”¨è‡ªèº«ä¸èƒ½å†è¢«ä¿®æ”¹ï¼Œä½†æ˜¯å®ƒæŒ‡å‘çš„å¯¹è±¡æ˜¯å¯å˜çš„ã€‚
- varï¼šå¯å˜å¼•ç”¨ï¼Œå˜é‡åœ¨åˆå§‹åŒ–ä¹‹åå¯ä»¥å†è¢«ä¿®æ”¹ï¼Œvarå¼•ç”¨è‡ªèº«å¯ä»¥è¢«ä¿®æ”¹ï¼Œä½†æ˜¯å®ƒçš„ç±»å‹ä¸å¯ä»¥æ”¹å˜ã€‚

**ä¸¾ä¾‹**

```kotlin
val name =  "Nick"
var age = 10
```

é»˜è®¤æƒ…å†µä¸‹ï¼Œåº”è¯¥å°½å¯èƒ½çš„ä½¿ç”¨valå…³é”®å­—æ¥å£°æ˜å˜é‡ï¼Œä»…åœ¨å¿…è¦çš„æ—¶å€™ä½¿ç”¨varï¼Œä½¿ç”¨ä¸å¯å˜å¼•ç”¨ï¼Œä¸å¯ä»¥å¯¹è±¡ä»¥åŠæ— å‰¯ä½œç”¨çš„å‡½æ•°å¯ä»¥è®©ä½ çš„ä»£ç æ›´åŠ æ¥è¿‘å‡½æ•°å¼ç¼–ç¨‹é£æ ¼ã€‚

æ³¨ï¼šè¿™é‡Œæä¸€ä¸‹Kotlinçš„packageç»“æ„ï¼Œå’ŒJavaä¸€æ ·Kotlinä¹Ÿæœ‰åŒ…çš„æ¦‚å¿µï¼Œä½†æ˜¯Kotlinå¯¹æºç çš„æ–‡ä»¶ç»„ç»‡æ›´ä¸ºè‡ªç”±ï¼Œå¤šä¸ªç±»å¯ä»¥åœ¨åŒä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œæ–‡ä»¶çš„åå­—å’Œç›®å½•ä¹Ÿå¯ä»¥éšæ„é€‰æ‹©ï¼Œä½†æ˜¯æˆ‘ä»¬è¿˜æ˜¯
ä¼šæŒ‰ç…§Javaçš„ç›®å½•å¸ƒå±€å»ç»„ç»‡æºç ï¼Œè¿™æ˜¯ä¸€ç§è‰¯å¥½çš„å®è·µï¼Œä½†åœ¨Kotlinä¸­å¾ˆå¤šç±»éƒ½éå¸¸å°ï¼Œä¾‹å¦‚æ•°æ®ç±»ï¼Œè¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬é€šå¸¸æŠŠå®ƒæ”¾åœ¨ä¸€ä¸ªæ–‡ä»¶é‡Œã€‚


# ä¸‰ æ§åˆ¶è¯­å¥

Kotlinå¸¸è§çš„æ§åˆ¶è¯­å¥æœ‰ï¼š

- æ¡ä»¶è¡¨è¾¾å¼ifã€when
- å¼‚å¸¸å¤„ç†try/catchã€throw
- å¾ªç¯è¡¨è¾¾å¼for/inã€whileä¸do/while

Kotlinçš„æ§åˆ¶è¯­å¥å’ŒJavaæœ‰æ‰€åŒºåˆ«ğŸ¤”ï¼Œå®ƒä»¬å…·å¤‡æ›´å¼ºå¤§çš„åŠŸèƒ½ï¼Œåœ¨ä»‹ç»æ§åˆ¶è¯­å¥ä¹‹å‰ï¼Œæˆ‘ä»¬è¦å…ˆç†è§£ä¸¤æ¡è§„åˆ™ï¼š

- å‡ºæ¥å¾ªç¯è¯­å¥å¤–ï¼Œå…¶ä»–è¡¨è¾¾å¼æ˜¯æœ‰æœ‰è¿”å›å€¼çš„
- åœ¨ifã€whenã€tryç­‰ä»£ç å—ä¸­ï¼Œæœ€åçš„è¡¨è¾¾å¼å°±æ˜¯è¦è¿”å›çš„ç»“æœ

æœ‰äº†ä¸Šé¢ä¸¤æ¡è§„åˆ™ï¼Œæˆ‘ä»¬ä¸éš¾ç†è§£ä»¥ä¸‹ä¾‹å­ã€‚

**ä¸¾ä¾‹**

```kotlin
val a = 1
val b = 2

val ifResult = if (a > b) a else b

val whenResult = when (a > b) {
    true -> a
    else -> b
}

val number = try {
    Integer.parseInt("1")
} catch (e: NumberFormatException) {
    null
}
```
Kotlinæ²¡æœ‰é‚£ç§Javaä¸­å¸¸è§„çš„forå¾ªç¯ï¼Œä½†æ˜¯æä¾›äº†æ›´ä¸ºå¼ºå¤§çš„for/inå¾ªç¯ï¼Œå®ƒå¯ä»¥ç”¨æ¥å˜é‡åŒºé—´ã€æ•°åˆ—å’Œé›†åˆç­‰ã€‚

```kotlin
for (i: Int in 1..100){
    Logger.d(i)
}
```


## æ•°å­—

|Type	|Bit width|
|:------|:--------|
|Double	|64
|Float	|32
|Long	|64
|Int	|32
|Short	|16
|Byte	|8

Int?æˆ–è€…æ³›å‹ä¼šå¯¹æ•°å­—è¿›è¡Œè‡ªåŠ¨è£…ç®±ï¼Œè£…ç®±åçš„æ•°å­—ä¿ç•™äº†ç›¸ç­‰æ€§ï¼Œä½†æ˜¯æ²¡æœ‰ä¿ç•™åŒä¸€æ€§ã€‚

```kotlin
val a: Int = 10000
print(a === a) // è¾“å‡ºâ€œtrueâ€
val boxedA: Int? = a
val anotherBoxedA: Int? = a
print(boxedA == anotherBoxedA) // è¾“å‡ºâ€œtrueâ€
print(boxedA === anotherBoxedA) // ï¼ï¼ï¼è¾“å‡ºâ€œfalseâ€ï¼ï¼ï¼
```
æ•°å­—ç±»å‹ä¸æ”¯æŒéšå¼è½¬æ¢ï¼Œæ¯ä¸ªæ•°å­—ç±»å‹éƒ½æ”¯æŒå¦‚ä¸‹æ˜¾å¼è½¬æ¢ï¼š

- toByte(): Byte
- toShort(): Short
- toInt(): Int
- toLong(): Long
- toFloat(): Float
- toDouble(): Double
toChar(): Char

Kotlinæ”¯æŒæ•°å­—è¿ç®—çš„æ ‡å‡†é›†ï¼Œå®ƒè¿˜è‡ªå·±çš„ä½è¿ç®—æ“ä½œç¬¦ï¼š

- shl(bits) â€“ æœ‰ç¬¦å·å·¦ç§» (Java çš„ <<)
- shr(bits) â€“ æœ‰ç¬¦å·å³ç§» (Java çš„ >>)
- ushr(bits) â€“ æ— ç¬¦å·å³ç§» (Java çš„ >>>)
- and(bits) â€“ ä½ä¸
- or(bits) â€“ ä½æˆ–
- xor(bits) â€“ ä½å¼‚æˆ–
- inv() â€“ ä½é

## å­—ç¬¦

å­—ç¬¦ç”¨Charè¡¨ç¤ºï¼Œå®ƒä»¬ä¸èƒ½ç›´æ¥å½“åšæ•°å­—ï¼Œå¯ä»¥è°ƒç”¨ä¸Šè¿°æ–¹æ³•è¿›è¡Œæ˜¾ç¤ºè½¬æ¢ã€‚å€¼ç”¨''æ‹¬èµ·æ¥ã€‚æ”¯æŒè½¬ä¹‰åºåˆ—ï¼š

- \t
- \b
- \n
- \r
- \'
- \"
- \\
- \$

è‹¥éœ€è¦å¯ç©ºå¼•ç”¨å­—ç¬¦ä¼šè¢«è£…ç®±ï¼Œè£…ç®±æ“ä½œä¸ä¼šä¿ç•™åŒä¸€æ€§ã€‚

## å­—ç¬¦ä¸²

å­—ç¬¦ä¸²ç”¨Stringç±»å‹æ¥è¡¨ç¤ºã€‚

```
//å¯ä»¥ä½¿ç”¨ç´¢å¼•è¿ç®—ç¬¦è®¿é—®
str[i]

//å¯ä»¥forå¾ªç¯è¿­ä»£å­—ç¬¦ä¸²
for(c in str){
}

//æ”¯æŒæ¨¡æ¿è¡¨è¾¾å¼
val a = "abc"
val s1 = "i + $a"
val s2 = "i + ${a.length}"
```
## å¸ƒå°”

å¸ƒå°”ç”¨Booleanç±»å‹è¡¨ç¤ºï¼Œå®ƒæœ‰trueä¸falseä¸¤ä¸ªå€¼ï¼Œæ”¯æŒå¸ƒå°”è¿ç®—ï¼š

- || â€“ çŸ­è·¯é€»è¾‘æˆ–
- && â€“ çŸ­è·¯é€»è¾‘ä¸
- ! - é€»è¾‘é

è‹¥éœ€è¦å¯ç©ºå¼•ç”¨å¸ƒå°”ä¼šè¢«è£…ç®±ï¼Œè£…ç®±æ“ä½œä¸ä¼šä¿ç•™åŒä¸€æ€§ã€‚

## æ•°ç»„

æ•°ç»„ç”¨Arrayè¡¨ç¤ºï¼Œå®ƒå®šä¹‰äº†å¦‚ä¸‹å‡½æ•°ï¼š

```kotlin
public class Array<T> {
    /**
     * Creates a new array with the specified [size], where each element is calculated by calling the specified
     * [init] function. The [init] function returns an array element given its index.
     */
    public inline constructor(size: Int, init: (Int) -> T)

    /**
     * Returns the array element at the specified [index]. This method can be called using the
     * index operator:
     * ```
     * value = arr[index]
     * ```
     */
    public operator fun get(index: Int): T

    /**
     * Sets the array element at the specified [index] to the specified [value]. This method can
     * be called using the index operator:
     * ```
     * arr[index] = value
     * ```
     */
    public operator fun set(index: Int, value: T): Unit

    /**
     * Returns the number of elements in the array.
     */
    public val size: Int

    /**
     * Creates an iterator for iterating over the elements of the array.
     */
    public operator fun iterator(): Iterator<T>
}
```
åˆ›å»ºæ–¹æ³•

```
//åˆ›å»ºä¸€ä¸ªæ•°ç»„å¹¶ä¼ é€’å…ƒç´ å€¼ç»™å®ƒ
arrayOf(1, 2, 3)

// åˆ›å»ºä¸€ä¸ª Array<String> åˆå§‹åŒ–ä¸º ["0", "1", "4", "9", "16"]
val asc = Array(5, { i -> (i * i).toString() })
```

Kotlinä¹Ÿæ”¯æŒæ— è£…ç®±å¼€é”€çš„ä¸“é—¨çš„ç±»æ¥è¡¨ç¤ºåŸç”Ÿç±»å‹æ•°ç»„ï¼š

- ByteArray
- Shortrray
- IntArray

å®ƒä»¬ä¸Arrayæ²¡æœ‰ç»§æ‰¿å…³ç³»ï¼Œä½†æ˜¯æœ‰ç›¸åŒçš„æ–¹æ³•å±æ€§é›†ã€‚

```
val x: IntArray = intArrayOf(1, 2, 3)
x[0] = x[1] + x[2]
```

## è§£æ„å£°æ˜

>è§£æ„å£°æ˜æ˜¯å°†ä¸€ä¸ªå¯¹è±¡è§£æ„æˆå¤šä¸ªå˜é‡ï¼Œä¸€ä¸ªè§£æ„å£°æ˜ä¼šåŒæ—¶åˆ›å»ºå¤šä¸ªå˜é‡ã€‚

è¦å®ç°è§£æ„å£°æ˜ï¼Œæˆ‘ä»¬éœ€è¦æ·»åŠ componentNå‡½æ•°ï¼ŒcomponentNå‡½æ•°æŒ‡å®šè¦è¿”å›çš„åŸŸï¼Œå¹¶ä½¿ç”¨operatoræ ‡è®°

```kotlin
class Teacher(val name: String, val age: Int) : Person(name, age), IBehavior {

    override fun talk() {
        super<Person>.talk()
        super<IBehavior>.talk()
    }

    operator fun component1(): Any {
        return name
    }

    operator fun component2(): Any {
        return age
    }
}

```
ç„¶åæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨è§£æ„å£°æ˜æ‰¹é‡çš„åˆ›å»ºå˜é‡ï¼Œè§£æ„èµ‹å€¼æ˜¯æŒ‰ç…§omponentNå‡½æ•°çš„é¡ºåºæ¥æ‰§è¡Œçš„ã€‚

```kotlin
val teacher = Teacher("LiLei", 20)
val (name, age) = teacher

Logger.d("name: " + name)
Logger.d("age: " + age)
```

å¦‚æœæˆ‘ä»¬åœ¨è§£æ„å£°æ˜ä¸­ä¸éœ€è¦æŸä¸ªå˜é‡ï¼Œç”¨ä¸‹åˆ’çº¿ä»£æ›¿å³å¯ã€‚

```kotlin
val (_, age) = teacher
```

### forå¾ªç¯è§£æ„

è§£æ„å£°æ˜è¿˜å¯ä»¥ç”¨åœ¨forå¾ªç¯ä¸­ï¼š

```kotlin
ã€ã€
//å˜é‡ a å’Œ b çš„å€¼å–è‡ªå¯¹é›†åˆä¸­çš„å…ƒç´ ä¸Šè°ƒç”¨ component1() å’Œ component2() çš„è¿”å›å€¼ã€‚
for ((a, b) in collection) { â€¦â€¦ }
```

éå†Mapæˆ‘ä»¬ä¹Ÿæœ‰äº†æ›´ç®€å•çš„æ–¹å¼ï¼š

```kotlin
for((key, value) in map){
````//ä½¿ç”¨keyï¼Œvalue
}
```
æ ‡å‡†åº“ä¸ºäº†æˆ‘ä»¬å®ç°äº†æ‰©å±•

- é€šè¿‡æä¾›ä¸€ä¸ª iterator() å‡½æ•°å°†æ˜ å°„è¡¨ç¤ºä¸ºä¸€ä¸ªå€¼çš„åºåˆ—ï¼Œ
- é€šè¿‡æä¾›å‡½æ•° component1() å’Œ component2() æ¥å°†æ¯ä¸ªå…ƒç´ å‘ˆç°ä¸ºä¸€å¯¹ã€‚

```kotlin
operator fun <K, V> Map<K, V>.iterator(): Iterator<Map.Entry<K, V>> = entrySet().iterator()
operator fun <K, V> Map.Entry<K, V>.component1() = getKey()
operator fun <K, V> Map.Entry<K, V>.component2() = getValue()

```
### lambdaè¡¨è¾¾å¼è§£æ„

æˆ‘ä»¬å¯ä»¥å¯¹lambdaè¡¨è¾¾å¼å‚æ•°ä½¿ç”¨è§£æ„å£°æ˜è¯­æ³•ã€‚

```kotlin
{ a //-> â€¦â€¦ } // ä¸€ä¸ªå‚æ•°
{ a, b //-> â€¦â€¦ } // ä¸¤ä¸ªå‚æ•°
{ (a, b) //-> â€¦â€¦ } // ä¸€ä¸ªè§£æ„å¯¹
{ (a, b), c //-> â€¦â€¦ } // ä¸€ä¸ªè§£æ„å¯¹ä»¥åŠå…¶ä»–å‚æ•°
```